<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>net - The ICI Sockets Interface</TITLE></HEAD>
<META NAME="Author" CONTENT="Andy Newman">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#FF0000" VLINK="#800000" ALINK="#FF00FF">
<H1>net - The ICI Sockets Interface</H1>
<P>The <I>net</I>
extension is available on systems that provide BSD-compatible sockets calls
and for Win32 platforms. The extension allows ICI programs to access network
functions. The sockets extension is generally compatible with the C sockets
functions but uses types and calling semantics more akin to the ICI
environment.</P>
<P>The sockets extension introduces a new type, <I>
socket</I>, to hold socket objects. The new intrinsic function, <I>
socket</I>, returns a socket object.</P>

<H3>Prerequisites</H4>
<P>Use of the net module requires that icinet.<I>dll</I> and icinet.ici
(where <I>dll</I> is the extension for dynamically loaded libraries on
the current system) can be found on ICI's extension module search path.

<H3>Network Addresses</H3>
<P>The sockets interfaces specifies IP network addresses using strings.
Network addresses are of the form <I>port</I><B>@</B><I>host</I>
where the @host part is optional. The port may be specified as an integer
number or a string which is looked up in the services database.
If the port is a service name it may be in the form
<I>name</I><B>/</B><I>protocol</I>
with protocol being either <I>tcp</I>
or <I>udp</I>. The host portion of the address may be a domain name,
an IP address in dotted decimal notation or one of the special addresses
local (&quot;.&quot; - dot), any (&quot;?&quot;) or all (&quot;*&quot;).
If the host portion is omitted the default host depends on the context.
See the descriptions of the <I>connect</I>
and <I>bind</I>
functions below.</P>

<H3>Functions</H3>

<H4><A NAME="accept"></A>skt = net.accept(skt)</H4>
<P>Accept a connection to a TCP socket and return a new socket for that
connection.</P>

<H4><A NAME="bind"></A>skt = net.bind(skt [, address|int])</H4>
<P>Associate a local address for the socket (TCP or UDP). If the address
is not specified the system selects an unused local port number for the
socket. If the host portion of the address is not specified &quot;?&quot;
(any) is used. If the address is passed as an integer it specifies the port
number to be bound, the host portion is &quot;?&quot;. Bind returns the
socket parameter.</P>

<H4><A NAME="classof"/>string = class_of(ipaddr)</H4>
<P>Return the IP address class (either "A", "B", "C", or "D") of the
given ipaddr. The given ipaddr must be a string in dotted decimal form.

<H4><A NAME="connect"></A>skt = net.connect(skt, address)</H4>
<P>Establish a TCP connection to the specified address or associate the
address with as the destination for messages on a UDP socket. If the host
portion of the address is not specified &quot;.&quot; (dot) is used to
connect to the local host. The original socket is returned.</P>

<H4><A NAME="domainname"></A>string = net.domainname()</H4>
<P>Return the domain name of the current host.</P>

<H4><A NAME="gethostbyname"></A>string = net.gethostbyname(string)</H4>
<P>Match a network address against the hosts database and return a hostname.</P>

<H4><A NAME="getpeername"></A>string = net.getpeername(skt)</H4>
<P>Return the address of the <I>peer</I>
of a TCP socket.</P>

<H4><A NAME="getportno"></A>int = net.getportno(skt)</H4>
<P>Return the local port number assigned to a TCP or UDP socket.</P>

<H4><A NAME="getsockname"></A>string = net.getsockname(skt)</H4>
<P>Return the local address of a socket.</P>

<H4><A NAME="getsockopt"></A>int = net.getsockopt(skt, string, int)</H4>
<P>Retrieve the value of a socket <I>option</I>.
A socket may have various attributes associated with it. These are
accessed via the getsockopt and setsockopt functions. The attributes are
identified using string keys from the following list:</P>
<PRE>
	"debug"
	"reuseaddr"
	"keepalive"
	"dontroute"
	"useloopback"
	"linger"
	"broadcast"
	"oobinline"
	"sndbuf"
	"rcvbuf"
	"type"
	"error"
</PRE>

<H4><A NAME="hostname"></A>string = net.hostname()</H4>
<P>Return the name of the current host.</P>

<H4><A NAME="listen"></A>skt = net.listen(skt)</H4>
<P>Allow connections to a TCP socket. Returns the socket passed.</P>

<H4><A NAME="network_of"></A>string = network_of(ipaddr)</H4>
<P>Returns the dotted decimal network address of the supplied dotted
decimal IP address. That is, 1, 2 or 3 of the trailing elements
of the IP address will replaced by 0 in the returned address,
depending on the network class of the address. See also net.class_of().

<H4><A NAME="recv"></A>string = net.recv(skt, int)</H4>
<P>Receive data from a socket and return it as a string. The int parameter
fives the maximum size of message that will be received.</P>

<H4><A NAME="recvfrom"></A>struct = net.recvfrom(skt, int)</H4>
<P>Receive a message on a socket and return a struct containing the data of
the message, in string, and the source address of the data.
The int parameter gives the maximum number of bytes to receive.
The result is a struct with the keys <CODE>msg</CODE>
and <CODE>addr</CODE>
used to access the returned information.</P>

<H4><A NAME="select"></A>struct = net.select([int,] set|NULL [, set|NULL [, set|NULL]])</H4>
<P>Check sockets for I/O readiness with optional timeout. Select may
be passed up to three sets of sockets that are checked for readiness to
perform I/O. The first set holds the sockets to test for input pending,
the second set the sockets to test for output able and the third set
the sockets to test for exceptional states. NULL may be passed in place
of a set parameter to avoid passing empty sets. An integer may also appear
in the parameter list. This integer specifies the number of milliseconds
to wait for the sockets to become ready. If a zero timeout is passed the
sockets are polled to test their state. If no timeout is passed the call
blocks until at least one of the sockets is ready for I/O.</P>
<P>The result of select is a struct containing three sets, of sockets,
identified by the keys <CODE>read</CODE>,
<CODE>write</CODE> and <CODE>except</CODE>.</P>

<H4><A NAME="send"></A>net.send(skt, string)</H4>
<P>Send the content of the string on a socket.</P>

<H4><A NAME="sendto"></A>net.sendto(skt, string, string)</H4>
<P>Send the data in the second parameter to the specified address.</P>

<H4><A NAME="setsockopt"></A>net.setsockopt(skt, string, int)</H4>
<P>Set a socket option (see getsockopt for option names) to the integer
value.</P>

<H4><A NAME="sktno"></A>int = net.sktno(skt)</H4>
<P>Return the file descriptor associated with a socket.</P>

<H4><A NAME="sktopen"></A>file = net.sktopen(skt [, mode])</H4>
<P>Open a socket as a file, for input or output according to
<I>mode</I> (see <I>fopen</I>). This function is not available on
WIN32 platforms.</P>

<H4><A NAME="socket"></A>skt = net.socket(string)</H4>
<P>Create and return a new socket object of the specified protocol.
The string, the protocol, may be one of <I>tcp</I>
 or <I>udp</I>. For example,</P>
<PRE>
    skt = socket(&quot;tcp&quot;);
</PRE>

<H4><A NAME="socketpair"></A>array = net.socketpair()</H4>
<P>Returns an array containing a pair of connected sockets.</P>

<H4><A NAME="username"></A>string = net.username([int])</H4>
<P>Return the name of the owner of the current process or if an integer,
user number, is passed, of that user.</P>

</BODY>
</HTML>
